---
const { lang } = Astro.props;

import frFooter from "../sitecontent/fr/footer.json";
import enFooter from "../sitecontent/en/footer.json";

import langMap from "../sitecontent/lang-map.json";

const content = lang === "fr" ? frFooter : enFooter;

// Figure out current slug (same as in Header)
const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, "");
const parts = pathname.split("/").filter(Boolean); // e.g. ["fr","notre-mission"]
const currentSlug = parts[1] ?? "";

const otherLang = lang === "fr" ? "en" : "fr";
const mappedSlug = (langMap as any)[lang][currentSlug] ?? "";

// Build toggle URL
const toggleUrl = `${import.meta.env.BASE_URL}${otherLang}/${mappedSlug}`;


---

<footer>
  <div class="footer-logo">
    <img
      src={`${import.meta.env.BASE_URL}windmill.gif`}
      alt="Animated logo"
      class="footer-gif"
      width="66"
      height="66"
    />
  </div>

  <div class="footer-container">
    <div class="footer-item">
      <a href={`${import.meta.env.BASE_URL}${lang}/contact/`}>
        {content.labels.hours} &#x2197;
      </a>
    </div>

    <div class="footer-item">
      <a href={`${import.meta.env.BASE_URL}${lang}/contact/`}>
        {content.labels.address} &#x2197;
      </a>
    </div>

    <div class="footer-item">
      <a href="tel:+5142770232">{content.labels.phone}</a>
    </div>

    <div class="footer-item">
      <a href="mailto:capucine_et_tournesol@hotmail.com">
        {content.labels.email}
      </a>
    </div>

    <div class="footer-item">
      <a
        href="https://www.facebook.com/pages/Boulangerie-Capucine-et-Tournesol/184532918320389"
        target="_blank"
        rel="noopener noreferrer"
      >
        {content.labels.facebook}
      </a>
    </div>
        <!-- Language toggle -->
    <div class="footer-item lang-toggle">
      <a href={toggleUrl}>{otherLang.toUpperCase()}</a>
    </div>
  </div>

  <div class="footer-copyright">
    Site design by:
    <span>
      <a style="color: inherit;"
         href="https://www.marknicolasnicol.com"
         target="_blank"
         rel="noopener noreferrer">MNN</a>
    </span>
  </div>
  <div class="footer-copyright">&copy; <span id="year"></span> Capucine et Tournesol</div>
</footer>
